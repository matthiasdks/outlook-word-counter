/*! For license information please see taskpane.js.LICENSE.txt */
(()=>{function e(){var n,r,o="function"==typeof Symbol?Symbol:{},c=o.iterator||"@@iterator",i=o.toStringTag||"@@toStringTag";function a(e,o,c,i){var a=o&&o.prototype instanceof l?o:l,s=Object.create(a.prototype);return t(s,"_invoke",function(e,t,o){var c,i,a,l=0,s=o||[],d=!1,f={p:0,n:0,v:n,a:y,f:y.bind(n,4),d:function(e,t){return c=e,i=0,a=n,f.n=t,u}};function y(e,t){for(i=e,a=t,r=0;!d&&l&&!o&&r<s.length;r++){var o,c=s[r],y=f.p,p=c[2];e>3?(o=p===t)&&(a=c[(i=c[4])?5:(i=3,3)],c[4]=c[5]=n):c[0]<=y&&((o=e<2&&y<c[1])?(i=0,f.v=t,f.n=c[1]):y<p&&(o=e<3||c[0]>t||t>p)&&(c[4]=e,c[5]=t,f.n=p,i=0))}if(o||e>1)return u;throw d=!0,t}return function(o,s,p){if(l>1)throw TypeError("Generator is already running");for(d&&1===s&&y(s,p),i=s,a=p;(r=i<2?n:a)||!d;){c||(i?i<3?(i>1&&(f.n=-1),y(i,a)):f.n=a:f.v=a);try{if(l=2,c){if(i||(o="next"),r=c[o]){if(!(r=r.call(c,a)))throw TypeError("iterator result is not an object");if(!r.done)return r;a=r.value,i<2&&(i=0)}else 1===i&&(r=c.return)&&r.call(c),i<2&&(a=TypeError("The iterator does not provide a '"+o+"' method"),i=1);c=n}else if((r=(d=f.n<0)?a:e.call(t,f))!==u)break}catch(e){c=n,i=1,a=e}finally{l=1}}return{value:r,done:d}}}(e,c,i),!0),s}var u={};function l(){}function s(){}function d(){}r=Object.getPrototypeOf;var f=[][c]?r(r([][c]())):(t(r={},c,function(){return this}),r),y=d.prototype=l.prototype=Object.create(f);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,t(e,i,"GeneratorFunction")),e.prototype=Object.create(y),e}return s.prototype=d,t(y,"constructor",d),t(d,"constructor",s),s.displayName="GeneratorFunction",t(d,i,"GeneratorFunction"),t(y),t(y,i,"Generator"),t(y,c,function(){return this}),t(y,"toString",function(){return"[object Generator]"}),(e=function(){return{w:a,m:p}})()}function t(e,n,r,o){var c=Object.defineProperty;try{c({},"",{})}catch(e){c=0}t=function(e,n,r,o){function i(n,r){t(e,n,function(e){return this._invoke(n,r,e)})}n?c?c(e,n,{value:r,enumerable:!o,configurable:!o,writable:!o}):e[n]=r:(i("next",0),i("throw",1),i("return",2))},t(e,n,r,o)}function n(e,t,n,r,o,c,i){try{var a=e[c](i),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,o)}function r(){return o.apply(this,arguments)}function o(){var t;return t=e().m(function t(){var n,r,o,u,l,s;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:return n=document.getElementById("count-words"),r=document.getElementById("loading"),o=document.getElementById("error"),u=document.getElementById("results"),n.disabled=!0,r.style.display="block",o.style.display="none",u.style.display="none",e.p=1,e.n=2,c();case 2:if(l=e.v){e.n=3;break}throw new Error("Kein E-Mail-Inhalt gefunden. Bitte wählen Sie eine E-Mail aus.");case 3:a(i(l)),e.n=5;break;case 4:e.p=4,s=e.v,console.error("Fehler beim Zählen der Wörter:",s),o.textContent=s.message||"Ein unbekannter Fehler ist aufgetreten.",o.style.display="block";case 5:return e.p=5,n.disabled=!1,r.style.display="none",e.f(5);case 6:return e.a(2)}},t,null,[[1,4,5,6]])}),o=function(){var e=this,r=arguments;return new Promise(function(o,c){var i=t.apply(e,r);function a(e){n(i,o,c,a,u,"next",e)}function u(e){n(i,o,c,a,u,"throw",e)}a(void 0)})},o.apply(this,arguments)}function c(){return new Promise(function(e,t){Office.context.mailbox.item.body.getAsync(Office.CoercionType.Text,function(n){n.status===Office.AsyncResultStatus.Succeeded?e(n.value):t(new Error("Fehler beim Abrufen des E-Mail-Inhalts: "+n.error.message))})})}function i(e){var t=e.trim();if(!t)return{words:0,characters:0,charactersNoSpaces:0,paragraphs:0,sentences:0,avgWordsPerSentence:0,readingTimeMinutes:0};var n=t.split(/\s+/).filter(function(e){return e.length>0}).length,r=t.length,o=t.replace(/\s/g,"").length,c=t.split(/\n\s*\n/).filter(function(e){return e.trim().length>0}).length,i=t.split(/[.!?]+/).filter(function(e){return e.trim().length>0}).length;return{words:n,characters:r,charactersNoSpaces:o,paragraphs:c,sentences:i,avgWordsPerSentence:i>0?Math.round(n/i*10)/10:0,readingTimeMinutes:Math.ceil(n/200)}}function a(e){document.getElementById("word-count").textContent=e.words.toLocaleString("de-DE"),document.getElementById("char-count").textContent=e.characters.toLocaleString("de-DE"),document.getElementById("char-no-spaces").textContent=e.charactersNoSpaces.toLocaleString("de-DE"),document.getElementById("paragraph-count").textContent=e.paragraphs.toLocaleString("de-DE"),document.getElementById("sentence-count").textContent=e.sentences.toLocaleString("de-DE"),document.getElementById("avg-words-sentence").textContent=e.avgWordsPerSentence.toLocaleString("de-DE"),document.getElementById("reading-time").textContent="".concat(e.readingTimeMinutes," Min."),document.getElementById("results").style.display="block"}Office.onReady(function(e){e.host===Office.HostType.Outlook&&(document.getElementById("count-words").onclick=r,function(){try{var e,t=null===(e=Office.context)||void 0===e||null===(e=e.mailbox)||void 0===e?void 0:e.userProfile;if(!t)return;var n=t.displayName||"",r=t.emailAddress||"";if(n||r){var o=document.getElementById("user-info"),c=document.getElementById("user-name"),i=document.getElementById("user-email");c&&(c.textContent=n),i&&(i.textContent=r),o&&(o.style.display="block")}}catch(e){console.warn("Konnte Nutzerinfo nicht lesen:",e)}}())})})();